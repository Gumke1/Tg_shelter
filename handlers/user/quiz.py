from aiogram import types, Router
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.utils.keyboard import InlineKeyboardBuilder

router = Router()

class QuizState(StatesGroup):
    question1 = State()
    question2 = State()
    question3 = State()
    question4 = State()
    question5 = State()
    results = State()

quiz_data = {
    "question1": {
        "question": "ü§î –ß—Ç–æ —Ç—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å?",
        "options": {
            "lazy": "üò¥ –°–ø–∞—Ç—å",
            "playful": "üòº –ò–≥—Ä–∞—Ç—å",
            "calm": "üßò –ú–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å",
            "adventurous": "üó∫Ô∏è –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å"
        }
    },
    "question2": {
        "question": "üòæ –ö–∞–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å –Ω–∞ –ª—é–¥–µ–π?",
        "options": {
            "shy": "üôà –ü—Ä—è—á—É—Å—å",
            "curious": "üëÄ –°–º–æ—Ç—Ä—é",
            "grumpy": "ü¶π –®–∏–ø–ª—é",
            "friendly": "üòΩ –ú—É—Ä–ª—ã–∫–∞—é"
        }
    },
    "question3": {
        "question": "üòª –õ—é–±–∏–º—ã–π –¥–µ–ª–∏–∫–∞—Ç–µ—Å?",
        "options": {
            "greedy": "üêü –†—ã–±–∫–∞",
            "chill": "üåø –ú—è—Ç–∞",
            "classic": "ü•õ –ú–æ–ª–æ–∫–æ",
            "gourmet": "üç£ –≠–∫–∑–æ—Ç–∏–∫–∞"
        }
    },
    "question4": {
        "question": "üè° –õ—é–±–∏–º–æ–µ –º–µ—Å—Ç–æ?",
        "options": {
            "comfy": "üí∫ –ö—Ä–µ—Å–ª–æ",
            "observant": "ü™ú –®–∫–∞—Ñ",
            "simple": "üì¶ –ö–æ—Ä–æ–±–∫–∞",
            "foodie": "üçï –ö—É—Ö–Ω—è"
        }
    },
    "question5": {
        "question": "ü§® –ß—Ç–æ –æ –ø—Ä–∞–≤–∏–ª–∞—Ö?",
        "options": {
            "rebellious": "üòà –õ–æ–º–∞—Ç—å!",
            "obedient": "üòá –°–ª—É—à–∞—é—Å—å",
            "clueless": "‚ùì –ß—Ç–æ?",
            "bossy": "üëë –Ø –ø—Ä–∞–≤!"
        }
    }
}

cat_descriptions = {
    "lazy": "üò¥ –¢—ã –ª–µ–Ω–∏–≤—ã–π –∫–æ—Ç–∏–∫! üéâ –¢–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –Ω–µ–∂–∏—Ç—å—Å—è –Ω–∞ —Å–æ–ª–Ω—ã—à–∫–µ, —Å–ª–∞–¥–∫–æ —Å–ø–∞—Ç—å –∏ –Ω–µ —É—Ç—Ä—É–∂–¥–∞—Ç—å —Å–µ–±—è –ª–∏—à–Ω–∏–º–∏ –¥–≤–∏–∂–µ–Ω–∏—è–º–∏. –¢–≤–æ—è –∂–∏–∑–Ω—å - —ç—Ç–æ –æ–∞–∑–∏—Å —Ä–µ–ª–∞–∫—Å–∞ –∏ –±–µ–∑–º—è—Ç–µ–∂–Ω–æ—Å—Ç–∏. –î—Ä—É–≥–∏–µ –∫–æ—Ç–∏–∫–∏ –∑–∞–≤–∏–¥—É—é—Ç —Ç–≤–æ–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –æ—Ç–∫–ª—é—á–∞—Ç—å—Å—è –æ—Ç —Å—É–µ—Ç—ã –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–º –º–æ–º–µ–Ω—Ç–æ–º –ø–æ–∫–æ—è. –ü–æ–º–Ω–∏: –∏–Ω–æ–≥–¥–∞ –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å - —ç—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å!",
    "playful": "üòº –¢—ã –∏–≥—Ä–∏–≤—ã–π –∫–æ—Ç! üéâ –≠–Ω–µ—Ä–≥–∏—è –±—å–µ—Ç –∫–ª—é—á–æ–º, –∏ —Ç—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º –∏ —à–∞–ª–æ—Å—Ç—è–º. –õ–∞–∑–µ—Ä–Ω–∞—è —É–∫–∞–∑–∫–∞, –º—è—á–∏–∫, –ø–µ—Ä—ã—à–∫–æ - –≤—Å–µ —ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –≤ —Ç–µ–±–µ –±—É—Ä—é –≤–æ—Å—Ç–æ—Ä–≥–∞! –¢—ã –∑–∞—Ä–∞–∂–∞–µ—à—å —Å–≤–æ–∏–º –ø–æ–∑–∏—Ç–∏–≤–æ–º –æ–∫—Ä—É–∂–∞—é—â–∏—Ö –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–∞–µ—à—å –∑–∞—Å–∫—É—á–∞—Ç—å. –¢–≤–æ—è –∂–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω–æ—Å—Ç—å - —ç—Ç–æ —Ç–≤–æ–π –≥–ª–∞–≤–Ω—ã–π –∫–æ–∑—ã—Ä—å!",
    "calm": "üßò –¢—ã —Å–ø–æ–∫–æ–π–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã —Ü–µ–Ω–∏—à—å –≥–∞—Ä–º–æ–Ω–∏—é, —Ç–∏—à–∏–Ω—É –∏ —É–º–∏—Ä–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ. –ú–µ–¥–∏—Ç–∞—Ü–∏—è - —Ç–≤–æ–µ –≤—Ç–æ—Ä–æ–µ –∏–º—è! –í –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —Ç—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å —Ö–ª–∞–¥–Ω–æ–∫—Ä–æ–≤–∏–µ –∏ —Ä–∞—Å—Å—É–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –¢–≤–æ—è –º—É–¥—Ä–æ—Å—Ç—å –ø–æ–º–æ–≥–∞–µ—Ç –¥—Ä—É–≥–∏–º –∫–æ—Ç–∏–∫–∞–º –Ω–∞—Ö–æ–¥–∏—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –≥—É—Ä—É –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞!",
    "adventurous": "üó∫Ô∏è –¢—ã –∫–æ—Ç-–ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫! üéâ –ù–µ –±–æ–∏—à—å—Å—è –Ω–µ–∏–∑–≤–µ–¥–∞–Ω–Ω–æ–≥–æ, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–µ–∏–∑–≤–µ–¥–∞–Ω–Ω—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã. –ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∫–∏, –≤—ã—Å–æ–∫–∏–µ —à–∫–∞—Ñ—ã, —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–≤–∞–ª—ã - –≤—Å–µ —ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –≤ —Ç–µ–±–µ –Ω–µ–ø–æ–¥–¥–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å! –¢–≤–æ—è —Å–º–µ–ª–æ—Å—Ç—å –∏ –∂–∞–∂–¥–∞ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç –¥—Ä—É–≥–∏—Ö –∫–æ—Ç–∏–∫–æ–≤ –Ω–∞ –ø–æ–¥–≤–∏–≥–∏!",
    "shy": "üôà –¢—ã –∑–∞—Å—Ç–µ–Ω—á–∏–≤—ã–π –∫–æ—Ç! üéâ –¢—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –º–∏—Ä–æ–º –∏–∑–¥–∞–ª–µ–∫–∞, –Ω–µ –ø—Ä–∏–≤–ª–µ–∫–∞—è –∫ —Å–µ–±–µ –ª–∏—à–Ω–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –¢–≤–æ—è —Å–∫—Ä–æ–º–Ω–æ—Å—Ç—å –∏ –Ω–µ–∂–Ω–æ—Å—Ç—å –ø–æ–∫–æ—Ä—è—é—Ç —Å–µ—Ä–¥—Ü–∞. –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —Ü–µ–Ω–∏—Ç–µ–ª—å —É—é—Ç–∞ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞, –∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å—Å—è –ø–µ—Ä–µ–¥ –¥—Ä—É–≥–∏–º–∏ –∫–æ—Ç–∏–∫–∞–º–∏. –ù–æ –∫–æ–≥–¥–∞ —Ç—ã –¥–æ–≤–µ—Ä—è–µ—à—å –∫–æ–º—É-—Ç–æ, —Ç–≤–æ—è –ø—Ä–µ–¥–∞–Ω–Ω–æ—Å—Ç—å –Ω–µ –∑–Ω–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü!",
    "curious": "üëÄ –¢—ã –ª—é–±–æ–ø—ã—Ç–Ω—ã–π –∫–æ—Ç! üéâ –¢–µ–±–µ –≤—Å–µ–≥–¥–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ–∫—Ä—É–≥, –∏ —Ç—ã –Ω–µ –º–æ–∂–µ—à—å —É—Å—Ç–æ—è—Ç—å –ø–µ—Ä–µ–¥ –∏—Å–∫—É—à–µ–Ω–∏–µ–º –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ –∫–∞–∂–¥—ã–π —É–≥–æ–ª–æ–∫. –¢–≤–æ–π —É–º –∏ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –¥–µ—Ç–∞–ª—è–º –ø–æ—Ä–∞–∂–∞—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –¥–µ—Ç–µ–∫—Ç–∏–≤ –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π —Ä–∞–∑–≥–∞–¥–∞—Ç—å –ª—é–±—É—é –∑–∞–≥–∞–¥–∫—É. –¢–≤–æ—è –∂–∞–∂–¥–∞ –∑–Ω–∞–Ω–∏–π –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º —á–ª–µ–Ω–æ–º –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã!",
    "grumpy": "ü¶π –¢—ã —Å–µ—Ä–¥–∏—Ç—ã–π –∫–æ—Ç! üéâ –ù–æ –≤ –≥–ª—É–±–∏–Ω–µ –¥—É—à–∏ —Ç—ã –æ—á–µ–Ω—å –¥–æ–±—Ä—ã–π –∏ —Ä–∞–Ω–∏–º—ã–π. –¢–≤–æ—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏ —Å–∏–ª–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –≤—ã–∑—ã–≤–∞—é—Ç —É–≤–∞–∂–µ–Ω–∏–µ. –¢—ã –Ω–µ –ª—é–±–∏—à—å, –∫–æ–≥–¥–∞ —Ç–µ–±—è —Ç—Ä–æ–≥–∞—é—Ç –±–µ–∑ —Å–ø—Ä–æ—Å–∞, –∏ –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –¥–∞—Ç—å –æ—Ç–ø–æ—Ä –æ–±–∏–¥—á–∏–∫–∞–º. –ù–æ –µ—Å–ª–∏ —Ç—ã –∫–æ–≥–æ-—Ç–æ –ø–æ–ª—é–±–∏—à—å, —Ç–æ –±—É–¥–µ—à—å –≤–µ—Ä–µ–Ω –µ–º—É –¥–æ –∫–æ–Ω—Ü–∞!",
    "friendly": "üòΩ –¢—ã –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥ –Ω–æ–≤—ã–º –¥—Ä—É–∑—å—è–º –∏ –ª–µ–≥–∫–æ –Ω–∞—Ö–æ–¥–∏—à—å –æ–±—â–∏–π —è–∑—ã–∫ —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ—Ç–∏–∫–∞–º–∏. –¢–≤–æ—è –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ª—é–±–æ–≤—å –∫ –ª—é–¥—è–º –¥–µ–ª–∞—é—Ç —Ç–µ–±—è –¥—É—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏. –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –º–∏—Ä–æ—Ç–≤–æ—Ä–µ—Ü, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π –ø—Ä–∏–π—Ç–∏ –Ω–∞ –ø–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É!",
    "greedy": "üêü –¢—ã –∂–∞–¥–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –≤—Å–µ–≥–¥–∞ –∏—â–µ—à—å –≤–∫—É—Å–Ω—è—à–∫–∏ –∏ –Ω–µ –º–æ–∂–µ—à—å —É—Å—Ç–æ—è—Ç—å –ø–µ—Ä–µ–¥ –ª–∞–∫–æ–º—Å—Ç–≤–∞–º–∏. –¢–≤–æ—è –ª—é–±–æ–≤—å –∫ –µ–¥–µ –∑–∞—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–∞! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –≥—É—Ä–º–∞–Ω –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–µ–π –µ–¥–µ. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–º –∫—É—Å–æ—á–∫–æ–º –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –¥—Ä—É–≥–∏—Ö –∫–æ—Ç–∏–∫–æ–≤ —Ü–µ–Ω–∏—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Ä–∞–¥–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏!",
    "chill": "üåø –¢—ã —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –Ω–∞—Å–ª–∞–∂–¥–∞–µ—à—å—Å—è –∂–∏–∑–Ω—å—é –∏ –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—à—å –ø–æ –ø—É—Å—Ç—è–∫–∞–º. –¢–≤–æ–π –ø–æ—Ñ–∏–≥–∏–∑–º –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç! –¢—ã —É–º–µ–µ—à—å –æ—Ç–∫–ª—é—á–∞—Ç—å—Å—è –æ—Ç –ø—Ä–æ–±–ª–µ–º –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–∞–¥–æ—Å—Ç—å –≤ –º–µ–ª–æ—á–∞—Ö. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –≤ –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –¥—Ä—É–≥–æ–º!",
    "classic": "ü•õ –¢—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫–æ—Ç! üéâ –¢—ã —Ü–µ–Ω–∏—à—å —Ç—Ä–∞–¥–∏—Ü–∏–∏, —É—é—Ç –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å. –¢–≤–æ—è –∏–∑—ã—Å–∫–∞–Ω–Ω–æ—Å—Ç—å –∏ —Ö–æ—Ä–æ—à–∏–µ –º–∞–Ω–µ—Ä—ã –≤–æ—Å—Ö–∏—â–∞—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –∞—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–µ–º –≤–æ—Å–ø–∏—Ç–∞–Ω–∏–∏. –¢–≤–æ—è –ª—é–±–æ–≤—å –∫ –ø–æ—Ä—è–¥–∫—É –∏ –≥–∞—Ä–º–æ–Ω–∏–∏ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –æ–±—Ä–∞–∑—Ü–æ–º –¥–ª—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è!",
    "gourmet": "üç£ –¢—ã –∫–æ—Ç-–≥—É—Ä–º–∞–Ω! üéâ –¢—ã –æ–±–æ–∂–∞–µ—à—å –∏–∑—ã—Å–∫–∞–Ω–Ω—ã–µ –±–ª—é–¥–∞ –∏ —Ä–∞–∑–±–∏—Ä–∞–µ—à—å—Å—è –≤ –¥–µ–ª–∏–∫–∞—Ç–µ—Å–∞—Ö. –¢–≤–æ–π –≤–∫—É—Å –∏ —É–º–µ–Ω–∏–µ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∂–∏–∑–Ω—å—é –ø–æ—Ä–∞–∂–∞—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —Ü–µ–Ω–∏—Ç–µ–ª—å –≤—ã—Å–æ–∫–æ–π –∫—É—Ö–Ω–∏, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å –æ–±—ã—á–Ω—ã–π –æ–±–µ–¥ –≤ –ø—Ä–∞–∑–¥–Ω–∏–∫ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –¥—Ä—É–≥–∏—Ö –∫–æ—Ç–∏–∫–æ–≤ –Ω–∞ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–≤–∏–≥–∏!",
    "comfy": "üí∫ –¢—ã —É—é—Ç–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –ª—é–±–∏—à—å —Ç–µ–ø–ª–æ, –∫–æ–º—Ñ–æ—Ä—Ç –∏ –º—è–≥–∫–∏–µ –ø–æ–¥—É—à–∫–∏. –¢–≤–æ—è –º—è–≥–∫–æ—Å—Ç—å –∏ –∂–µ–ª–∞–Ω–∏–µ –æ–±–Ω–∏–º–∞—Ç—å—Å—è —Å–æ–≥—Ä–µ–≤–∞—é—Ç —Å–µ—Ä–¥—Ü–∞. –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –º–∞—Å—Ç–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —É—é—Ç–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–µ–º –æ—Ç–¥—ã—Ö–µ. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–∞—Å—Å–ª–∞–±–ª—è—Ç—å—Å—è –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∂–∏–∑–Ω—å—é –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –¥—Ä—É–≥–æ–º!",
    "observant": "ü™ú –¢—ã –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –≤–∏–¥–∏—à—å –≤—Å–µ –≤–æ–∫—Ä—É–≥ –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —É–ø—É—Å–∫–∞–µ—à—å –∏–∑ –≤–∏–¥—É. –¢–≤–æ—è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–ª–∞–¥ —É–º–∞ –≤–ø–µ—á–∞—Ç–ª—è—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –¥–µ—Ç–µ–∫—Ç–∏–≤ –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π —Ä–∞–∑–≥–∞–¥–∞—Ç—å –ª—é–±—É—é –∑–∞–≥–∞–¥–∫—É. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞–º–µ—á–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º!",
    "simple": "üì¶ –¢—ã –ø—Ä–æ—Å—Ç–æ–π –∫–æ—Ç! üéâ –¢–µ–±–µ –Ω–µ –Ω—É–∂–Ω—ã –∏–∑–ª–∏—à–µ—Å—Ç–≤–∞, —á—Ç–æ–±—ã –±—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–º. –¢–≤–æ—è –Ω–µ–ø—Ä–∏—Ç—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–º–µ–Ω–∏–µ —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –º–µ–ª–æ—á–∞–º –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —Ñ–∏–ª–æ—Å–æ—Ñ –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Ä–∞–¥–æ—Å—Ç—è—Ö –∂–∏–∑–Ω–∏. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—å —Å—á–∞—Å—Ç—å–µ –≤ –º–∞–ª–æ–º –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –æ–±—Ä–∞–∑—Ü–æ–º –¥–ª—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è!",
    "foodie": "üçï –¢—ã –∫–æ—Ç-–≥—É—Ä–º–∞–Ω! üéâ –î–ª—è —Ç–µ–±—è –µ–¥–∞ ‚Äì —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ. –¢–≤–æ—è –ª—é–±–æ–≤—å –∫ –∫—É–ª–∏–Ω–∞—Ä–∏–∏ –∏ –≤–∫—É—Å–Ω—ã–º –±–ª—é–¥–∞–º –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —à–µ—Ñ-–ø–æ–≤–∞—Ä –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –∑–Ω–∞—é—â–∏–π —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ —à–µ–¥–µ–≤—Ä—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –¥—Ä—É–≥–∏—Ö –∫–æ—Ç–∏–∫–æ–≤ –Ω–∞ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã!",
    "rebellious": "üòà –¢—ã –±—É–Ω—Ç–∞—Ä—Å–∫–∏–π –∫–æ—Ç! üéâ –¢—ã –Ω–µ –ø—Ä–∏–∑–Ω–∞–µ—à—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–æ–≤ –∏ –¥–µ–ª–∞–µ—à—å –≤—Å–µ –ø–æ-—Å–≤–æ–µ–º—É. –¢–≤–æ—è —Å–º–µ–ª–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤—ã–∑—ã–≤–∞—é—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–µ—Ä –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π –±–æ—Ä–æ—Ç—å—Å—è –∑–∞ —Å–≤–æ–∏ –ø—Ä–∞–≤–∞. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏–¥—Ç–∏ –ø—Ä–æ—Ç–∏–≤ —Ç–µ—á–µ–Ω–∏—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –¥—Ä—É–≥–∏—Ö –∫–æ—Ç–∏–∫–æ–≤ –Ω–∞ –ø–æ–¥–≤–∏–≥–∏!",
    "obedient": "üòá –¢—ã –ø–æ—Å–ª—É—à–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—à—å –ø—Ä–∞–≤–∏–ª–∞–º –∏ —Ä–∞–¥—É–µ—à—å —Ö–æ–∑—è–µ–≤. –¢–≤–æ—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –≤–ø–µ—á–∞—Ç–ª—è—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–Ω–≥–µ–ª –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π –ø–æ–º–æ—á—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–ª—É—à–∞—Ç—å—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º!",
    "clueless": "‚ùì –¢—ã –Ω–∞–∏–≤–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ–∫—Ä—É–≥. –¢–≤–æ—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ —á–∏—Å—Ç–æ—Ç–∞ –¥—É—à–∏ —É–º–∏–ª—è—é—Ç. –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π —Ä–µ–±–µ–Ω–æ–∫ –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π –∫ –∏–≥—Ä–∞–º –∏ –∑–∞–±–∞–≤–∞–º. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–¥–∏–≤–ª—è—Ç—å—Å—è –∏ —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –º–µ–ª–æ—á–∞–º –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º –¥—Ä—É–≥–æ–º!",
    "bossy": "üëë –¢—ã –≤–ª–∞—Å—Ç–Ω—ã–π –∫–æ—Ç! üéâ –¢—ã –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—à—å, —á–µ–≥–æ —Ö–æ—á–µ—à—å, –∏ –¥–æ–±–∏–≤–∞–µ—à—å—Å—è —Å–≤–æ–µ–≥–æ. –¢–≤–æ—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤–ø–µ—á–∞—Ç–ª—è—é—Ç! –¢—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π –ª–∏–¥–µ—Ä –∫–æ—à–∞—á—å–µ–≥–æ –º–∏—Ä–∞, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã–π –≤–∑—è—Ç—å –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç—å –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º —á–ª–µ–Ω–æ–º –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥—ã!"
}

@router.message(lambda message: message.text == "–ö–∞–∫–æ–π —Ç—ã –∫–æ—Ç?ü§®")
async def start_quiz(message: types.Message, state: FSMContext):
    await state.set_state(QuizState.question1)
    await send_question(message, state, "question1")

async def send_question(message: types.Message, state: FSMContext, question_key: str):
    """Sends a question to the user with inline keyboard options."""
    data = quiz_data[question_key]
    builder = InlineKeyboardBuilder()
    buttons = []
    for trait, option_text in data["options"].items():
        buttons.append(types.InlineKeyboardButton(text=option_text, callback_data=f"quiz:{question_key}:{trait}"))

    # Divide the buttons into chunks of 2
    for i in range(0, len(buttons), 2):
        builder.row(*buttons[i:i + 2])  # Add a row with up to 2 buttons

    await message.answer(data["question"], reply_markup=builder.as_markup())

@router.callback_query(lambda c: c.data.startswith("quiz:"))
async def process_answer(callback_query: types.CallbackQuery, state: FSMContext):
    """Processes the user's answer and sends the next question or results."""
    data = callback_query.data.split(":")
    question_key = data[1]
    trait = data[2]

    # Store the answer in the state
    user_data = await state.get_data()
    if 'traits' not in user_data:
        user_data['traits'] = {}
    user_data['traits'][question_key] = trait
    await state.set_data(user_data)

    # Determine the next question or show results
    if question_key == "question1":
        await state.set_state(QuizState.question2)
        await send_question(callback_query.message, state, "question2")
    elif question_key == "question2":
        await state.set_state(QuizState.question3)
        await send_question(callback_query.message, state, "question3")
    elif question_key == "question3":
        await state.set_state(QuizState.question4)
        await send_question(callback_query.message, state, "question4")
    elif question_key == "question4":
        await state.set_state(QuizState.question5)
        await send_question(callback_query.message, state, "question5")
    elif question_key == "question5":
        await state.set_state(QuizState.results)
        await show_results(callback_query.message, state)

    await callback_query.answer()  # Acknowledge the callback query

async def show_results(message: types.Message, state: FSMContext):
    """Calculates the user's cat type and displays the results."""
    user_data = await state.get_data()
    traits = user_data.get("traits", {})

    # Count trait occurrences
    trait_counts = {}
    for question_key, trait in traits.items():
        trait_counts[trait] = trait_counts.get(trait, 0) + 1

    # Determine the dominant cat type
    if trait_counts:
        dominant_cat_type = max(trait_counts, key=trait_counts.get)
    else:
        dominant_cat_type = "unknown"  # Handle case of no answers

    # Get cat description
    if dominant_cat_type != "unknown":
        description = cat_descriptions[dominant_cat_type]
    else:
        description = "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à —Ç–∏–ø –∫–æ—Ç–∏–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑!"

    # Display results
    result_message = f"üéâ –¢—ã - {dominant_cat_type}! üéâ\n\n{description}"
    await message.answer(result_message)

    # Clear the state
    await state.clear()

def register_handlers(dp):
    dp.include_router(router)